<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.1 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="Joining Data">

  
  <link rel="alternate" hreflang="en-us" href="https://psqf6250.brandonlebeau.org/rcode/data_joins/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#1565c0">
  

  
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" media="print" onload="this.media='all'">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.3aad675291f323c3cd47ae187f0bf0d6.css">

  




  

  


  
  

  

  
  <link rel="manifest" href="/index.webmanifest">
  

  <link rel="icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="https://psqf6250.brandonlebeau.org/rcode/data_joins/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="PSQF 6250">
  <meta property="og:url" content="https://psqf6250.brandonlebeau.org/rcode/data_joins/">
  <meta property="og:title" content="Joining Data | PSQF 6250">
  <meta property="og:description" content="Joining Data"><meta property="og:image" content="https://psqf6250.brandonlebeau.org/media/blue-balloon.jpg">
  <meta property="twitter:image" content="https://psqf6250.brandonlebeau.org/media/blue-balloon.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-02-18T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-02-18T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Joining Data | PSQF 6250</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7de282f2047be3c570af3a58788341e7.js"></script>

  

<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">PSQF 6250</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">PSQF 6250</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#logistics"><span>Logistics</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/syllabus/"><span>Syllabus</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/schedule/"><span>Schedule</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/content/"><span>Content</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/rcode/"><span>R Code</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/assignments/"><span>Assignments</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>People</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    





<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <button class="form-control sidebar-search js-search">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      
      
      


  
    
    
    
    
      
    
    

    
      <ul class="nav docs-sidenav">
        <li class=""><a href="/rcode/">R Syntax</a></li>
    
      


  <li class=""><a href="/rcode/graphics/">Graphics</a></li>



  <li class=""><a href="/rcode/r-basics/">R Basics</a></li>



  <li class=""><a href="/rcode/ggplot2_extensions/">ggplot2 extensions</a></li>



  <li class=""><a href="/rcode/graphics-tips/">Graphics Tips</a></li>



  <li class=""><a href="/rcode/data_munging/">Data Manipulation</a></li>



  <li class=""><a href="/rcode/r_scripts/">R Scripts</a></li>



  <li class=""><a href="/rcode/eda/">Exploratory Data Analysis</a></li>



  <li class=""><a href="/rcode/projects/">R Projects -  RStudio</a></li>



  <li class=""><a href="/rcode/data_import/">Data Import</a></li>



  <li class=""><a href="/rcode/data_restructuring/">Data Restructuring</a></li>



  <li class="active"><a href="/rcode/data_joins/">Joining Data</a></li>



  <li class=""><a href="/rcode/factors/">Factors</a></li>



  <li class=""><a href="/rcode/strings/">Working with Character Strings</a></li>



  <li class=""><a href="/rcode/model-intro/">Model Introduction</a></li>



  <li class=""><a href="/rcode/model-part2/">Building Upon Linear Models</a></li>



  <li class=""><a href="/rcode/adv-model/">Advanced Modeling Topics</a></li>



  <li class=""><a href="/rcode/model-assumptions/">Model Assumptions</a></li>



  <li class=""><a href="/rcode/misc-model/">Miscellaneous Modeling Topics</a></li>

      
    

    
      </ul>
    

  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          

          <h1>Joining Data</h1>

          <div class="article-style">
            
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="TOC">

</div>

<p>Another common data manipulation task is to join multiple data sources into a single data file for an analysis. This task is most easily accomplished using a set of <code>join</code> functions found in the <code>dplyr</code> package. In this set of notes we are going to focus on mutating joins and filtering joins. There is another class of joins called set operations. I use these much less frequently, but for those interested, see the text in the R for Data Science book <a href="http://r4ds.had.co.nz/relational-data.html" class="uri">http://r4ds.had.co.nz/relational-data.html</a>.</p>
<p>For this set of notes, we are going to make use of two packages:</p>
<pre class="r"><code>library(tidyverse)
# install.packages(&#39;Lahman&#39;)
library(Lahman)</code></pre>
<p>The <code>Lahman</code> package contains data from the Major League Baseball (MLB), a professional baseball association in the United States. For this section, we are going to focus on the following three data tables, <code>Teams</code>, <code>Salaries</code>, and <code>Managers</code>. I print the first ten rows of the data for each table below.</p>
<pre class="r"><code>head(Teams, n = 10)</code></pre>
<pre><code>##    yearID lgID teamID franchID divID Rank  G Ghome  W  L DivWin WCWin LgWin
## 1    1871   NA    BS1      BNA  &lt;NA&gt;    3 31    NA 20 10   &lt;NA&gt;  &lt;NA&gt;     N
## 2    1871   NA    CH1      CNA  &lt;NA&gt;    2 28    NA 19  9   &lt;NA&gt;  &lt;NA&gt;     N
## 3    1871   NA    CL1      CFC  &lt;NA&gt;    8 29    NA 10 19   &lt;NA&gt;  &lt;NA&gt;     N
## 4    1871   NA    FW1      KEK  &lt;NA&gt;    7 19    NA  7 12   &lt;NA&gt;  &lt;NA&gt;     N
## 5    1871   NA    NY2      NNA  &lt;NA&gt;    5 33    NA 16 17   &lt;NA&gt;  &lt;NA&gt;     N
## 6    1871   NA    PH1      PNA  &lt;NA&gt;    1 28    NA 21  7   &lt;NA&gt;  &lt;NA&gt;     Y
## 7    1871   NA    RC1      ROK  &lt;NA&gt;    9 25    NA  4 21   &lt;NA&gt;  &lt;NA&gt;     N
## 8    1871   NA    TRO      TRO  &lt;NA&gt;    6 29    NA 13 15   &lt;NA&gt;  &lt;NA&gt;     N
## 9    1871   NA    WS3      OLY  &lt;NA&gt;    4 32    NA 15 15   &lt;NA&gt;  &lt;NA&gt;     N
## 10   1872   NA    BL1      BLC  &lt;NA&gt;    2 58    NA 35 19   &lt;NA&gt;  &lt;NA&gt;     N
##    WSWin   R   AB   H X2B X3B HR BB SO SB CS HBP SF  RA  ER  ERA CG SHO SV
## 1   &lt;NA&gt; 401 1372 426  70  37  3 60 19 73 16  NA NA 303 109 3.55 22   1  3
## 2   &lt;NA&gt; 302 1196 323  52  21 10 60 22 69 21  NA NA 241  77 2.76 25   0  1
## 3   &lt;NA&gt; 249 1186 328  35  40  7 26 25 18  8  NA NA 341 116 4.11 23   0  0
## 4   &lt;NA&gt; 137  746 178  19   8  2 33  9 16  4  NA NA 243  97 5.17 19   1  0
## 5   &lt;NA&gt; 302 1404 403  43  21  1 33 15 46 15  NA NA 313 121 3.72 32   1  0
## 6   &lt;NA&gt; 376 1281 410  66  27  9 46 23 56 12  NA NA 266 137 4.95 27   0  0
## 7   &lt;NA&gt; 231 1036 274  44  25  3 38 30 53 10  NA NA 287 108 4.30 23   1  0
## 8   &lt;NA&gt; 351 1248 384  51  34  6 49 19 62 24  NA NA 362 153 5.51 28   0  0
## 9   &lt;NA&gt; 310 1353 375  54  26  6 48 13 48 13  NA NA 303 137 4.37 32   0  0
## 10  &lt;NA&gt; 617 2571 753 106  31 14 29 28 53 18  NA NA 434 166 2.90 48   1  1
##    IPouts  HA HRA BBA SOA   E DP    FP                    name
## 1     828 367   2  42  23 243 24 0.834    Boston Red Stockings
## 2     753 308   6  28  22 229 16 0.829 Chicago White Stockings
## 3     762 346  13  53  34 234 15 0.818  Cleveland Forest Citys
## 4     507 261   5  21  17 163  8 0.803    Fort Wayne Kekiongas
## 5     879 373   7  42  22 235 14 0.840        New York Mutuals
## 6     747 329   3  53  16 194 13 0.845  Philadelphia Athletics
## 7     678 315   3  34  16 220 14 0.821   Rockford Forest Citys
## 8     750 431   4  75  12 198 22 0.845          Troy Haymakers
## 9     846 371   4  45  13 218 20 0.850     Washington Olympics
## 10   1548 573   3  63  77 432 22 0.830      Baltimore Canaries
##                                 park attendance BPF PPF teamIDBR teamIDlahman45
## 1                South End Grounds I         NA 103  98      BOS            BS1
## 2            Union Base-Ball Grounds         NA 104 102      CHI            CH1
## 3       National Association Grounds         NA  96 100      CLE            CL1
## 4                     Hamilton Field         NA 101 107      KEK            FW1
## 5           Union Grounds (Brooklyn)         NA  90  88      NYU            NY2
## 6           Jefferson Street Grounds         NA 102  98      ATH            PH1
## 7  Agricultural Society Fair Grounds         NA  97  99      ROK            RC1
## 8                 Haymakers&#39; Grounds         NA 101 100      TRO            TRO
## 9                   Olympics Grounds         NA  94  98      OLY            WS3
## 10                    Newington Park         NA 106 102      BAL            BL1
##    teamIDretro
## 1          BS1
## 2          CH1
## 3          CL1
## 4          FW1
## 5          NY2
## 6          PH1
## 7          RC1
## 8          TRO
## 9          WS3
## 10         BL1</code></pre>
<pre class="r"><code>head(Salaries, n = 10)</code></pre>
<pre><code>##    yearID teamID lgID  playerID salary
## 1    1985    ATL   NL barkele01 870000
## 2    1985    ATL   NL bedrost01 550000
## 3    1985    ATL   NL benedbr01 545000
## 4    1985    ATL   NL  campri01 633333
## 5    1985    ATL   NL ceronri01 625000
## 6    1985    ATL   NL chambch01 800000
## 7    1985    ATL   NL dedmoje01 150000
## 8    1985    ATL   NL forstte01 483333
## 9    1985    ATL   NL garbege01 772000
## 10   1985    ATL   NL harpete01 250000</code></pre>
<pre class="r"><code>head(Managers, n = 10)</code></pre>
<pre><code>##     playerID yearID teamID lgID inseason  G  W  L rank plyrMgr
## 1  wrighha01   1871    BS1   NA        1 31 20 10    3       Y
## 2   woodji01   1871    CH1   NA        1 28 19  9    2       Y
## 3  paborch01   1871    CL1   NA        1 29 10 19    8       Y
## 4  lennobi01   1871    FW1   NA        1 14  5  9    8       Y
## 5  deaneha01   1871    FW1   NA        2  5  2  3    8       Y
## 6  fergubo01   1871    NY2   NA        1 33 16 17    5       Y
## 7  mcbridi01   1871    PH1   NA        1 28 21  7    1       Y
## 8  hastisc01   1871    RC1   NA        1 25  4 21    9       Y
## 9   pikeli01   1871    TRO   NA        1  4  1  3    6       Y
## 10 cravebi01   1871    TRO   NA        2 25 12 12    6       Y</code></pre>
<div id="inner-join" class="section level2">
<h2>Inner Join</h2>
<p>The most basic join is the inner join. This join takes two tables and returns values if key variables match in both tables. If rows do not match on the key variables, these observations are removed. Suppose for example, we wanted to select the rows that matched between the <code>Teams</code> and <code>Salaries</code> data. This would be useful for example if we wished to calculate the average salary of the players for each team for every year.</p>
<p>This join could be done with the <code>inner_join</code> function.</p>
<pre class="r"><code>team_salary &lt;- inner_join(Teams, Salaries)</code></pre>
<pre><code>## Joining, by = c(&quot;yearID&quot;, &quot;lgID&quot;, &quot;teamID&quot;)</code></pre>
<pre class="r"><code>head(team_salary, n = 10)</code></pre>
<pre><code>##    yearID lgID teamID franchID divID Rank   G Ghome  W  L DivWin WCWin LgWin
## 1    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 2    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 3    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 4    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 5    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 6    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 7    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 8    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 9    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 10   1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
##    WSWin   R   AB    H X2B X3B  HR  BB  SO SB CS HBP SF  RA  ER  ERA CG SHO SV
## 1      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 2      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 3      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 4      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 5      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 6      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 7      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 8      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 9      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 10     N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
##    IPouts   HA HRA BBA SOA   E  DP    FP           name
## 1    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 2    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 3    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 4    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 5    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 6    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 7    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 8    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 9    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 10   4372 1512 134 642 776 159 197 0.976 Atlanta Braves
##                             park attendance BPF PPF teamIDBR teamIDlahman45
## 1  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 2  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 3  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 4  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 5  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 6  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 7  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 8  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 9  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 10 Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
##    teamIDretro  playerID salary
## 1          ATL barkele01 870000
## 2          ATL bedrost01 550000
## 3          ATL benedbr01 545000
## 4          ATL  campri01 633333
## 5          ATL ceronri01 625000
## 6          ATL chambch01 800000
## 7          ATL dedmoje01 150000
## 8          ATL forstte01 483333
## 9          ATL garbege01 772000
## 10         ATL harpete01 250000</code></pre>
<p>You’ll notice that there is only data from 1985 onward, the data in the <code>Teams</code> data from before 1985 have automatically been removed due to no matching data in the <code>Salaries</code> data. You may have also noticed, that I did not specify the variables to join by above, for interactive work this can be okay, but to be more reproducible, specifying the variables to join on would be better. The function call above can be modified to include this information.</p>
<pre class="r"><code>team_salary &lt;- inner_join(Teams, Salaries, by = c(&#39;yearID&#39;, &#39;teamID&#39;, &#39;lgID&#39;))
head(team_salary, n = 10)</code></pre>
<pre><code>##    yearID lgID teamID franchID divID Rank   G Ghome  W  L DivWin WCWin LgWin
## 1    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 2    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 3    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 4    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 5    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 6    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 7    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 8    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 9    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 10   1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
##    WSWin   R   AB    H X2B X3B  HR  BB  SO SB CS HBP SF  RA  ER  ERA CG SHO SV
## 1      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 2      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 3      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 4      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 5      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 6      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 7      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 8      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 9      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 10     N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
##    IPouts   HA HRA BBA SOA   E  DP    FP           name
## 1    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 2    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 3    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 4    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 5    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 6    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 7    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 8    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 9    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 10   4372 1512 134 642 776 159 197 0.976 Atlanta Braves
##                             park attendance BPF PPF teamIDBR teamIDlahman45
## 1  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 2  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 3  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 4  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 5  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 6  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 7  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 8  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 9  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 10 Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
##    teamIDretro  playerID salary
## 1          ATL barkele01 870000
## 2          ATL bedrost01 550000
## 3          ATL benedbr01 545000
## 4          ATL  campri01 633333
## 5          ATL ceronri01 625000
## 6          ATL chambch01 800000
## 7          ATL dedmoje01 150000
## 8          ATL forstte01 483333
## 9          ATL garbege01 772000
## 10         ATL harpete01 250000</code></pre>
<p>We could then use other <code>dplyr</code> verbs to calculate the average salary for every team by year and plot these.</p>
<pre class="r"><code>team_salary %&gt;%
  group_by(yearID, teamID) %&gt;%
  summarise(avg_salary = mean(salary, na.rm = TRUE)) %&gt;%
  ggplot(aes(x = yearID, y = avg_salary)) + 
  geom_line(size = 1) + 
  facet_wrap(~teamID)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;yearID&#39;. You can override using the
## `.groups` argument.</code></pre>
<p><img src="/rcode/data_joins_files/figure-html/avg_salary-1.png" width="672" /></p>
<p>Below is a diagram of the inner join found in the R for Data Science text, <a href="https://r4ds.had.co.nz/relational-data.html#inner-join">inner join diagram</a>.</p>
</div>
<div id="left-join" class="section level2">
<h2>Left Join</h2>
<p>This is by far the most common join I perform. Left join is more formally part of a group of operations called outer joins. Outer joins are useful when you want to use one data table as a base data set in which variables will be added to this data if the keys match. It is likely best shown with an example.</p>
<p>Suppose we wish to add the salary information to the <code>Teams</code> data. However, instead of using a <code>inner_join</code>, let’s use <code>left_join</code> to see the difference. <em>Note: I print only 10 rows of data with the <code>head()</code> function. This part of the code below would generally not be used.</em></p>
<pre class="r"><code>left_join(Teams, Salaries) %&gt;%
  head(n = 10)</code></pre>
<pre><code>## Joining, by = c(&quot;yearID&quot;, &quot;lgID&quot;, &quot;teamID&quot;)</code></pre>
<pre><code>##    yearID lgID teamID franchID divID Rank  G Ghome  W  L DivWin WCWin LgWin
## 1    1871   NA    BS1      BNA  &lt;NA&gt;    3 31    NA 20 10   &lt;NA&gt;  &lt;NA&gt;     N
## 2    1871   NA    CH1      CNA  &lt;NA&gt;    2 28    NA 19  9   &lt;NA&gt;  &lt;NA&gt;     N
## 3    1871   NA    CL1      CFC  &lt;NA&gt;    8 29    NA 10 19   &lt;NA&gt;  &lt;NA&gt;     N
## 4    1871   NA    FW1      KEK  &lt;NA&gt;    7 19    NA  7 12   &lt;NA&gt;  &lt;NA&gt;     N
## 5    1871   NA    NY2      NNA  &lt;NA&gt;    5 33    NA 16 17   &lt;NA&gt;  &lt;NA&gt;     N
## 6    1871   NA    PH1      PNA  &lt;NA&gt;    1 28    NA 21  7   &lt;NA&gt;  &lt;NA&gt;     Y
## 7    1871   NA    RC1      ROK  &lt;NA&gt;    9 25    NA  4 21   &lt;NA&gt;  &lt;NA&gt;     N
## 8    1871   NA    TRO      TRO  &lt;NA&gt;    6 29    NA 13 15   &lt;NA&gt;  &lt;NA&gt;     N
## 9    1871   NA    WS3      OLY  &lt;NA&gt;    4 32    NA 15 15   &lt;NA&gt;  &lt;NA&gt;     N
## 10   1872   NA    BL1      BLC  &lt;NA&gt;    2 58    NA 35 19   &lt;NA&gt;  &lt;NA&gt;     N
##    WSWin   R   AB   H X2B X3B HR BB SO SB CS HBP SF  RA  ER  ERA CG SHO SV
## 1   &lt;NA&gt; 401 1372 426  70  37  3 60 19 73 16  NA NA 303 109 3.55 22   1  3
## 2   &lt;NA&gt; 302 1196 323  52  21 10 60 22 69 21  NA NA 241  77 2.76 25   0  1
## 3   &lt;NA&gt; 249 1186 328  35  40  7 26 25 18  8  NA NA 341 116 4.11 23   0  0
## 4   &lt;NA&gt; 137  746 178  19   8  2 33  9 16  4  NA NA 243  97 5.17 19   1  0
## 5   &lt;NA&gt; 302 1404 403  43  21  1 33 15 46 15  NA NA 313 121 3.72 32   1  0
## 6   &lt;NA&gt; 376 1281 410  66  27  9 46 23 56 12  NA NA 266 137 4.95 27   0  0
## 7   &lt;NA&gt; 231 1036 274  44  25  3 38 30 53 10  NA NA 287 108 4.30 23   1  0
## 8   &lt;NA&gt; 351 1248 384  51  34  6 49 19 62 24  NA NA 362 153 5.51 28   0  0
## 9   &lt;NA&gt; 310 1353 375  54  26  6 48 13 48 13  NA NA 303 137 4.37 32   0  0
## 10  &lt;NA&gt; 617 2571 753 106  31 14 29 28 53 18  NA NA 434 166 2.90 48   1  1
##    IPouts  HA HRA BBA SOA   E DP    FP                    name
## 1     828 367   2  42  23 243 24 0.834    Boston Red Stockings
## 2     753 308   6  28  22 229 16 0.829 Chicago White Stockings
## 3     762 346  13  53  34 234 15 0.818  Cleveland Forest Citys
## 4     507 261   5  21  17 163  8 0.803    Fort Wayne Kekiongas
## 5     879 373   7  42  22 235 14 0.840        New York Mutuals
## 6     747 329   3  53  16 194 13 0.845  Philadelphia Athletics
## 7     678 315   3  34  16 220 14 0.821   Rockford Forest Citys
## 8     750 431   4  75  12 198 22 0.845          Troy Haymakers
## 9     846 371   4  45  13 218 20 0.850     Washington Olympics
## 10   1548 573   3  63  77 432 22 0.830      Baltimore Canaries
##                                 park attendance BPF PPF teamIDBR teamIDlahman45
## 1                South End Grounds I         NA 103  98      BOS            BS1
## 2            Union Base-Ball Grounds         NA 104 102      CHI            CH1
## 3       National Association Grounds         NA  96 100      CLE            CL1
## 4                     Hamilton Field         NA 101 107      KEK            FW1
## 5           Union Grounds (Brooklyn)         NA  90  88      NYU            NY2
## 6           Jefferson Street Grounds         NA 102  98      ATH            PH1
## 7  Agricultural Society Fair Grounds         NA  97  99      ROK            RC1
## 8                 Haymakers&#39; Grounds         NA 101 100      TRO            TRO
## 9                   Olympics Grounds         NA  94  98      OLY            WS3
## 10                    Newington Park         NA 106 102      BAL            BL1
##    teamIDretro playerID salary
## 1          BS1     &lt;NA&gt;     NA
## 2          CH1     &lt;NA&gt;     NA
## 3          CL1     &lt;NA&gt;     NA
## 4          FW1     &lt;NA&gt;     NA
## 5          NY2     &lt;NA&gt;     NA
## 6          PH1     &lt;NA&gt;     NA
## 7          RC1     &lt;NA&gt;     NA
## 8          TRO     &lt;NA&gt;     NA
## 9          WS3     &lt;NA&gt;     NA
## 10         BL1     &lt;NA&gt;     NA</code></pre>
<p>The first thing to notice is that now there are years in the yearID variable from before 1985, this was not the case in the above data joined using <code>inner_join</code>. If you scroll over to explore variables to the right, there are missing values for the salary variable. What <code>left_join</code> does when it doesn’t find a match in the table is to produce NA values, so all records within the joined data will be NA before 1985.</p>
<p>This is the major difference between outer joins and inner joins. Outer joins will preserve data in the keyed data that do not match and NA values are returned for non-matching values. For inner joins, any keys that do not match are removed.</p>
</div>
<div id="right-join" class="section level2">
<h2>Right Join</h2>
<p>A right join is similar to a left join, except the keyed table is the second one specified (the rightmost data). For example, if we wished for the salary information to be the keyed table, we could do that same specification as above, but use <code>right_join</code> instead of <code>left_join</code>. <em>Note: I print only 10 rows of data with the <code>head()</code> function. This part of the code below would generally not be used.</em></p>
<pre class="r"><code>right_join(Teams, Salaries) %&gt;%
  head(n = 10)</code></pre>
<pre><code>## Joining, by = c(&quot;yearID&quot;, &quot;lgID&quot;, &quot;teamID&quot;)</code></pre>
<pre><code>##    yearID lgID teamID franchID divID Rank   G Ghome  W  L DivWin WCWin LgWin
## 1    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 2    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 3    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 4    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 5    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 6    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 7    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 8    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 9    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 10   1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
##    WSWin   R   AB    H X2B X3B  HR  BB  SO SB CS HBP SF  RA  ER  ERA CG SHO SV
## 1      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 2      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 3      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 4      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 5      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 6      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 7      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 8      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 9      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 10     N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
##    IPouts   HA HRA BBA SOA   E  DP    FP           name
## 1    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 2    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 3    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 4    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 5    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 6    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 7    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 8    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 9    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 10   4372 1512 134 642 776 159 197 0.976 Atlanta Braves
##                             park attendance BPF PPF teamIDBR teamIDlahman45
## 1  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 2  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 3  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 4  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 5  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 6  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 7  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 8  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 9  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 10 Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
##    teamIDretro  playerID salary
## 1          ATL barkele01 870000
## 2          ATL bedrost01 550000
## 3          ATL benedbr01 545000
## 4          ATL  campri01 633333
## 5          ATL ceronri01 625000
## 6          ATL chambch01 800000
## 7          ATL dedmoje01 150000
## 8          ATL forstte01 483333
## 9          ATL garbege01 772000
## 10         ATL harpete01 250000</code></pre>
<p>This data is very similar (although not identical) to the one from the inner join above. Can you spot what is different?</p>
</div>
<div id="full-join" class="section level2">
<h2>Full Join</h2>
<p>Full join is the last type of outer join and this will return all values from both tables and NAs will be given for those keys that do not match. For example,</p>
<pre class="r"><code>full_join(Teams, Salaries) %&gt;%
  head(n = 10)</code></pre>
<pre><code>## Joining, by = c(&quot;yearID&quot;, &quot;lgID&quot;, &quot;teamID&quot;)</code></pre>
<pre><code>##    yearID lgID teamID franchID divID Rank  G Ghome  W  L DivWin WCWin LgWin
## 1    1871   NA    BS1      BNA  &lt;NA&gt;    3 31    NA 20 10   &lt;NA&gt;  &lt;NA&gt;     N
## 2    1871   NA    CH1      CNA  &lt;NA&gt;    2 28    NA 19  9   &lt;NA&gt;  &lt;NA&gt;     N
## 3    1871   NA    CL1      CFC  &lt;NA&gt;    8 29    NA 10 19   &lt;NA&gt;  &lt;NA&gt;     N
## 4    1871   NA    FW1      KEK  &lt;NA&gt;    7 19    NA  7 12   &lt;NA&gt;  &lt;NA&gt;     N
## 5    1871   NA    NY2      NNA  &lt;NA&gt;    5 33    NA 16 17   &lt;NA&gt;  &lt;NA&gt;     N
## 6    1871   NA    PH1      PNA  &lt;NA&gt;    1 28    NA 21  7   &lt;NA&gt;  &lt;NA&gt;     Y
## 7    1871   NA    RC1      ROK  &lt;NA&gt;    9 25    NA  4 21   &lt;NA&gt;  &lt;NA&gt;     N
## 8    1871   NA    TRO      TRO  &lt;NA&gt;    6 29    NA 13 15   &lt;NA&gt;  &lt;NA&gt;     N
## 9    1871   NA    WS3      OLY  &lt;NA&gt;    4 32    NA 15 15   &lt;NA&gt;  &lt;NA&gt;     N
## 10   1872   NA    BL1      BLC  &lt;NA&gt;    2 58    NA 35 19   &lt;NA&gt;  &lt;NA&gt;     N
##    WSWin   R   AB   H X2B X3B HR BB SO SB CS HBP SF  RA  ER  ERA CG SHO SV
## 1   &lt;NA&gt; 401 1372 426  70  37  3 60 19 73 16  NA NA 303 109 3.55 22   1  3
## 2   &lt;NA&gt; 302 1196 323  52  21 10 60 22 69 21  NA NA 241  77 2.76 25   0  1
## 3   &lt;NA&gt; 249 1186 328  35  40  7 26 25 18  8  NA NA 341 116 4.11 23   0  0
## 4   &lt;NA&gt; 137  746 178  19   8  2 33  9 16  4  NA NA 243  97 5.17 19   1  0
## 5   &lt;NA&gt; 302 1404 403  43  21  1 33 15 46 15  NA NA 313 121 3.72 32   1  0
## 6   &lt;NA&gt; 376 1281 410  66  27  9 46 23 56 12  NA NA 266 137 4.95 27   0  0
## 7   &lt;NA&gt; 231 1036 274  44  25  3 38 30 53 10  NA NA 287 108 4.30 23   1  0
## 8   &lt;NA&gt; 351 1248 384  51  34  6 49 19 62 24  NA NA 362 153 5.51 28   0  0
## 9   &lt;NA&gt; 310 1353 375  54  26  6 48 13 48 13  NA NA 303 137 4.37 32   0  0
## 10  &lt;NA&gt; 617 2571 753 106  31 14 29 28 53 18  NA NA 434 166 2.90 48   1  1
##    IPouts  HA HRA BBA SOA   E DP    FP                    name
## 1     828 367   2  42  23 243 24 0.834    Boston Red Stockings
## 2     753 308   6  28  22 229 16 0.829 Chicago White Stockings
## 3     762 346  13  53  34 234 15 0.818  Cleveland Forest Citys
## 4     507 261   5  21  17 163  8 0.803    Fort Wayne Kekiongas
## 5     879 373   7  42  22 235 14 0.840        New York Mutuals
## 6     747 329   3  53  16 194 13 0.845  Philadelphia Athletics
## 7     678 315   3  34  16 220 14 0.821   Rockford Forest Citys
## 8     750 431   4  75  12 198 22 0.845          Troy Haymakers
## 9     846 371   4  45  13 218 20 0.850     Washington Olympics
## 10   1548 573   3  63  77 432 22 0.830      Baltimore Canaries
##                                 park attendance BPF PPF teamIDBR teamIDlahman45
## 1                South End Grounds I         NA 103  98      BOS            BS1
## 2            Union Base-Ball Grounds         NA 104 102      CHI            CH1
## 3       National Association Grounds         NA  96 100      CLE            CL1
## 4                     Hamilton Field         NA 101 107      KEK            FW1
## 5           Union Grounds (Brooklyn)         NA  90  88      NYU            NY2
## 6           Jefferson Street Grounds         NA 102  98      ATH            PH1
## 7  Agricultural Society Fair Grounds         NA  97  99      ROK            RC1
## 8                 Haymakers&#39; Grounds         NA 101 100      TRO            TRO
## 9                   Olympics Grounds         NA  94  98      OLY            WS3
## 10                    Newington Park         NA 106 102      BAL            BL1
##    teamIDretro playerID salary
## 1          BS1     &lt;NA&gt;     NA
## 2          CH1     &lt;NA&gt;     NA
## 3          CL1     &lt;NA&gt;     NA
## 4          FW1     &lt;NA&gt;     NA
## 5          NY2     &lt;NA&gt;     NA
## 6          PH1     &lt;NA&gt;     NA
## 7          RC1     &lt;NA&gt;     NA
## 8          TRO     &lt;NA&gt;     NA
## 9          WS3     &lt;NA&gt;     NA
## 10         BL1     &lt;NA&gt;     NA</code></pre>
<p><em>Note: I print only 10 rows of data with the <code>head()</code> function. This part of the code below would generally not be used.</em></p>
<p>This data is very similar to the left join above, but not identical, can you tell the difference again?</p>
<p>Below is a diagram of the differences between the three outer joins from the R for Data Science text, <a href="https://r4ds.had.co.nz/relational-data.html#outer-join">outer joins diagram</a>.</p>
</div>
<div id="filtering-joins" class="section level2">
<h2>Filtering Joins</h2>
<p>I tend to not use filtering joins, however, these are useful to connect summary data back to the original rows in the data. For example, using the <code>team_salary</code> data created above, let’s select only the top 10 teams in terms of average salary from the year 2015.</p>
<pre class="r"><code>top_salary_15 &lt;- team_salary %&gt;%
  group_by(yearID, teamID) %&gt;%
  summarise(avg_salary = mean(salary, na.rm = TRUE)) %&gt;%
  filter(yearID == 2015) %&gt;%
  arrange(desc(avg_salary)) %&gt;%
  head(10)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;yearID&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre class="r"><code>top_salary_15</code></pre>
<pre><code>## # A tibble: 10 × 3
## # Groups:   yearID [1]
##    yearID teamID avg_salary
##     &lt;int&gt; &lt;fct&gt;       &lt;dbl&gt;
##  1   2015 LAN      7441103.
##  2   2015 NYA      7336274.
##  3   2015 DET      6891390 
##  4   2015 SFN      6100056.
##  5   2015 BOS      5659481.
##  6   2015 WAS      5365085.
##  7   2015 SEA      4888348 
##  8   2015 TEX      4791426.
##  9   2015 SLN      4586212.
## 10   2015 SDN      4555435.</code></pre>
<p>Although not impossible, it would be a bit more difficult to connect these teams and years back to the original data in the <code>team_salary</code> data. This can be done simply with a filtering join, namely a semi join.</p>
<pre class="r"><code>team_salary %&gt;%
  semi_join(top_salary_15) %&gt;%
  head(n = 10)</code></pre>
<pre><code>## Joining, by = c(&quot;yearID&quot;, &quot;teamID&quot;)</code></pre>
<pre><code>##    yearID lgID teamID franchID divID Rank   G Ghome  W  L DivWin WCWin LgWin
## 1    2015   AL    BOS      BOS     E    5 162    81 78 84      N     N     N
## 2    2015   AL    BOS      BOS     E    5 162    81 78 84      N     N     N
## 3    2015   AL    BOS      BOS     E    5 162    81 78 84      N     N     N
## 4    2015   AL    BOS      BOS     E    5 162    81 78 84      N     N     N
## 5    2015   AL    BOS      BOS     E    5 162    81 78 84      N     N     N
## 6    2015   AL    BOS      BOS     E    5 162    81 78 84      N     N     N
## 7    2015   AL    BOS      BOS     E    5 162    81 78 84      N     N     N
## 8    2015   AL    BOS      BOS     E    5 162    81 78 84      N     N     N
## 9    2015   AL    BOS      BOS     E    5 162    81 78 84      N     N     N
## 10   2015   AL    BOS      BOS     E    5 162    81 78 84      N     N     N
##    WSWin   R   AB    H X2B X3B  HR  BB   SO SB CS HBP SF  RA  ER  ERA CG SHO SV
## 1      N 748 5640 1495 294  33 161 478 1148 71 27  46 42 753 694 4.31  3  10 40
## 2      N 748 5640 1495 294  33 161 478 1148 71 27  46 42 753 694 4.31  3  10 40
## 3      N 748 5640 1495 294  33 161 478 1148 71 27  46 42 753 694 4.31  3  10 40
## 4      N 748 5640 1495 294  33 161 478 1148 71 27  46 42 753 694 4.31  3  10 40
## 5      N 748 5640 1495 294  33 161 478 1148 71 27  46 42 753 694 4.31  3  10 40
## 6      N 748 5640 1495 294  33 161 478 1148 71 27  46 42 753 694 4.31  3  10 40
## 7      N 748 5640 1495 294  33 161 478 1148 71 27  46 42 753 694 4.31  3  10 40
## 8      N 748 5640 1495 294  33 161 478 1148 71 27  46 42 753 694 4.31  3  10 40
## 9      N 748 5640 1495 294  33 161 478 1148 71 27  46 42 753 694 4.31  3  10 40
## 10     N 748 5640 1495 294  33 161 478 1148 71 27  46 42 753 694 4.31  3  10 40
##    IPouts   HA HRA BBA  SOA  E  DP    FP           name           park
## 1    4345 1486 178 478 1218 97 148 0.984 Boston Red Sox Fenway Park II
## 2    4345 1486 178 478 1218 97 148 0.984 Boston Red Sox Fenway Park II
## 3    4345 1486 178 478 1218 97 148 0.984 Boston Red Sox Fenway Park II
## 4    4345 1486 178 478 1218 97 148 0.984 Boston Red Sox Fenway Park II
## 5    4345 1486 178 478 1218 97 148 0.984 Boston Red Sox Fenway Park II
## 6    4345 1486 178 478 1218 97 148 0.984 Boston Red Sox Fenway Park II
## 7    4345 1486 178 478 1218 97 148 0.984 Boston Red Sox Fenway Park II
## 8    4345 1486 178 478 1218 97 148 0.984 Boston Red Sox Fenway Park II
## 9    4345 1486 178 478 1218 97 148 0.984 Boston Red Sox Fenway Park II
## 10   4345 1486 178 478 1218 97 148 0.984 Boston Red Sox Fenway Park II
##    attendance BPF PPF teamIDBR teamIDlahman45 teamIDretro  playerID   salary
## 1     2880694 104 107      BOS            BOS         BOS barnema01   508500
## 2     2880694 104 107      BOS            BOS         BOS bettsmo01   514500
## 3     2880694 104 107      BOS            BOS         BOS bogaexa01   543000
## 4     2880694 104 107      BOS            BOS         BOS bradlja02   528000
## 5     2880694 104 107      BOS            BOS         BOS breslcr01  2000000
## 6     2880694 104 107      BOS            BOS         BOS buchhcl01 12000000
## 7     2880694 104 107      BOS            BOS         BOS castiru01 11271000
## 8     2880694 104 107      BOS            BOS         BOS cecchga01   508500
## 9     2880694 104 107      BOS            BOS         BOS craigal01  5500000
## 10    2880694 104 107      BOS            BOS         BOS hanigry01  3500000</code></pre>
<p><em>Note: I print only 10 rows of data with the <code>head()</code> function. This part of the code below would generally not be used.</em></p>
<p>This operation selected only the rows that had the matching keys from the first table (note that the columns were not touched).</p>
<p>The opposite operation is to use an anti join, in this type of join, the rows that do not match will be returned.</p>
<pre class="r"><code>team_salary %&gt;%
  anti_join(top_salary_15) %&gt;%
  head(n = 10)</code></pre>
<pre><code>## Joining, by = c(&quot;yearID&quot;, &quot;teamID&quot;)</code></pre>
<pre><code>##    yearID lgID teamID franchID divID Rank   G Ghome  W  L DivWin WCWin LgWin
## 1    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 2    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 3    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 4    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 5    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 6    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 7    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 8    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 9    1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
## 10   1985   NL    ATL      ATL     W    5 162    81 66 96      N  &lt;NA&gt;     N
##    WSWin   R   AB    H X2B X3B  HR  BB  SO SB CS HBP SF  RA  ER  ERA CG SHO SV
## 1      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 2      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 3      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 4      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 5      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 6      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 7      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 8      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 9      N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
## 10     N 632 5526 1359 213  28 126 553 849 72 52  22 41 781 679 4.19  9   9 29
##    IPouts   HA HRA BBA SOA   E  DP    FP           name
## 1    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 2    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 3    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 4    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 5    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 6    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 7    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 8    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 9    4372 1512 134 642 776 159 197 0.976 Atlanta Braves
## 10   4372 1512 134 642 776 159 197 0.976 Atlanta Braves
##                             park attendance BPF PPF teamIDBR teamIDlahman45
## 1  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 2  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 3  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 4  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 5  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 6  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 7  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 8  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 9  Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
## 10 Atlanta-Fulton County Stadium    1350137 105 106      ATL            ATL
##    teamIDretro  playerID salary
## 1          ATL barkele01 870000
## 2          ATL bedrost01 550000
## 3          ATL benedbr01 545000
## 4          ATL  campri01 633333
## 5          ATL ceronri01 625000
## 6          ATL chambch01 800000
## 7          ATL dedmoje01 150000
## 8          ATL forstte01 483333
## 9          ATL garbege01 772000
## 10         ATL harpete01 250000</code></pre>
<p><em>Note: I print only 10 rows of data with the <code>head()</code> function. This part of the code below would generally not be used.</em></p>
<p>The sum of the number of rows in these two tables should equal the number of rows from the entire <code>team_salary</code> data table</p>
<pre class="r"><code>anti_rows &lt;- team_salary %&gt;%
  anti_join(top_salary_15) %&gt;%
  nrow()</code></pre>
<pre><code>## Joining, by = c(&quot;yearID&quot;, &quot;teamID&quot;)</code></pre>
<pre class="r"><code>semi_rows &lt;- team_salary %&gt;%
  semi_join(top_salary_15) %&gt;%
  nrow()</code></pre>
<pre><code>## Joining, by = c(&quot;yearID&quot;, &quot;teamID&quot;)</code></pre>
<pre class="r"><code>anti_rows + semi_rows == nrow(team_salary)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<div id="exercises" class="section level4">
<h4>Exercises</h4>
<ol style="list-style-type: decimal">
<li>Using the <code>Teams</code> and <code>Managers</code> data, join the two tables and only keep the matching observations in both tables. Note, you may need to specify the column names directly you wish to join by. What happens to the columns that have the same names but are not keys?</li>
<li>Using the same data tables from #1, add all the <code>Managers</code> variables to the <code>Teams</code> data while retaining all the rows for the <code>Teams</code> data.</li>
</ol>
</div>
</div>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/rcode/data_restructuring/" rel="next">Data Restructuring</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/rcode/factors/" rel="prev">Factors</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on Feb 18, 2021</p>

          



          




          


        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'event' : "Events",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/js/wowchemy.min.d4185df71ecf716f1c4e7ef5f3d4e2b8.js"></script>

    






</body>
</html>
