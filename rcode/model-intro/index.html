<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.1 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="Model Introduction">

  
  <link rel="alternate" hreflang="en-us" href="https://psqf6250.brandonlebeau.org/rcode/model-intro/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#1565c0">
  

  
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" media="print" onload="this.media='all'">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.2a5f61e11ca83c1781264fc4703f4117.css">

  




  

  


  
  

  

  
  <link rel="manifest" href="/index.webmanifest">
  

  <link rel="icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="https://psqf6250.brandonlebeau.org/rcode/model-intro/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="PSQF 6250">
  <meta property="og:url" content="https://psqf6250.brandonlebeau.org/rcode/model-intro/">
  <meta property="og:title" content="Model Introduction | PSQF 6250">
  <meta property="og:description" content="Model Introduction"><meta property="og:image" content="https://psqf6250.brandonlebeau.org/media/blue-balloon.jpg">
  <meta property="twitter:image" content="https://psqf6250.brandonlebeau.org/media/blue-balloon.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-03-16T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-03-16T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Model Introduction | PSQF 6250</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7de282f2047be3c570af3a58788341e7.js"></script>

  

<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">PSQF 6250</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">PSQF 6250</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#logistics"><span>Logistics</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/syllabus/"><span>Syllabus</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/schedule/"><span>Schedule</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/content/"><span>Content</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/rcode/"><span>R Code</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/assignments/"><span>Assignments</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>People</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    





<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <button class="form-control sidebar-search js-search">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      
      
      


  
    
    
    
    
      
    
    

    
      <ul class="nav docs-sidenav">
        <li class=""><a href="/rcode/">R Syntax</a></li>
    
      


  <li class=""><a href="/rcode/graphics/">Graphics</a></li>



  <li class=""><a href="/rcode/r-basics/">R Basics</a></li>



  <li class=""><a href="/rcode/ggplot2_extensions/">ggplot2 extensions</a></li>



  <li class=""><a href="/rcode/graphics-tips/">Graphics Tips</a></li>



  <li class=""><a href="/rcode/data_munging/">Data Manipulation</a></li>



  <li class=""><a href="/rcode/r_scripts/">R Scripts</a></li>



  <li class=""><a href="/rcode/eda/">Exploratory Data Analysis</a></li>



  <li class=""><a href="/rcode/projects/">R Projects -  RStudio</a></li>



  <li class=""><a href="/rcode/data_import/">Data Import</a></li>



  <li class=""><a href="/rcode/data_restructuring/">Data Restructuring</a></li>



  <li class=""><a href="/rcode/data_joins/">Joining Data</a></li>



  <li class=""><a href="/rcode/factors/">Factors</a></li>



  <li class=""><a href="/rcode/strings/">Working with Character Strings</a></li>



  <li class="active"><a href="/rcode/model-intro/">Model Introduction</a></li>



  <li class=""><a href="/rcode/model-part2/">Building Upon Linear Models</a></li>



  <li class=""><a href="/rcode/adv-model/">Advanced Modeling Topics</a></li>



  <li class=""><a href="/rcode/model-assumptions/">Model Assumptions</a></li>



  <li class=""><a href="/rcode/misc-model/">Miscellaneous Modeling Topics</a></li>



  <li class=""><a href="/rcode/reproducible-tables/">Reproducible Tables</a></li>



  <li class=""><a href="/rcode/interactive-graphics/">Interactive Graphics</a></li>



  <li class=""><a href="/rcode/user-functions/">User Created Functions</a></li>

      
    

    
      </ul>
    

  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          

          <h1>Model Introduction</h1>

          <div class="article-style">
            
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="TOC">

</div>

<p>This section of the notes is going to introduce you into the world of models in R. For the most part, we are going to stick with simple linear models and build up the various models using one function <code>lm</code>. The <code>lm</code> function is an extremely powerful function that can accomodate many different models in a single framework.</p>
<p>This section of notes is going to make use of four R packages:</p>
<pre class="r"><code>library(tidyverse)
library(modelr)
# install.packages(&quot;broom&quot;)
library(broom)
library(fivethirtyeight)</code></pre>
<div id="simple-linear-regression" class="section level2">
<h2>Simple Linear Regression</h2>
<p>First we need some data. We are going to explore the data from the <code>fivethirtyeight</code> package called <code>fandango</code>. Here are the first few rows:</p>
<pre class="r"><code>fandango</code></pre>
<pre><code>## # A tibble: 146 x 23
##    film    year rottentomatoes rottentomatoes_… metacritic metacritic_user  imdb
##    &lt;chr&gt;  &lt;dbl&gt;          &lt;int&gt;            &lt;int&gt;      &lt;int&gt;           &lt;dbl&gt; &lt;dbl&gt;
##  1 Aveng…  2015             74               86         66             7.1   7.8
##  2 Cinde…  2015             85               80         67             7.5   7.1
##  3 Ant-M…  2015             80               90         64             8.1   7.8
##  4 Do Yo…  2015             18               84         22             4.7   5.4
##  5 Hot T…  2015             14               28         29             3.4   5.1
##  6 The W…  2015             63               62         50             6.8   7.2
##  7 Irrat…  2015             42               53         53             7.6   6.9
##  8 Top F…  2014             86               64         81             6.8   6.5
##  9 Shaun…  2015             99               82         81             8.8   7.4
## 10 Love …  2015             89               87         80             8.5   7.8
## # … with 136 more rows, and 16 more variables: fandango_stars &lt;dbl&gt;,
## #   fandango_ratingvalue &lt;dbl&gt;, rt_norm &lt;dbl&gt;, rt_user_norm &lt;dbl&gt;,
## #   metacritic_norm &lt;dbl&gt;, metacritic_user_nom &lt;dbl&gt;, imdb_norm &lt;dbl&gt;,
## #   rt_norm_round &lt;dbl&gt;, rt_user_norm_round &lt;dbl&gt;, metacritic_norm_round &lt;dbl&gt;,
## #   metacritic_user_norm_round &lt;dbl&gt;, imdb_norm_round &lt;dbl&gt;,
## #   metacritic_user_vote_count &lt;int&gt;, imdb_user_vote_count &lt;int&gt;,
## #   fandango_votes &lt;int&gt;, fandango_difference &lt;dbl&gt;</code></pre>
<p>These data have 146 rows and 23 columns.</p>
<p>Suppose we were interested in exploring the relationship between ratings from rottentomatoes and metacritic. Note, we will not use the user rating for this exploration. A natural first step may be to look at a scatterplot of these data to explore the shape of the relationship.</p>
<pre class="r"><code>ggplot(fandango, aes(rottentomatoes, metacritic)) + 
  theme_bw() + 
  geom_point(size = 3)</code></pre>
<p><img src="/rcode/model-intro_files/figure-html/scatter-1.png" width="672" /></p>
<p>To better explore the relationship, including a smoother can be useful:</p>
<pre class="r"><code>ggplot(fandango, aes(rottentomatoes, metacritic)) + 
  theme_bw() + 
  geom_point(size = 3) + 
  geom_smooth(method = &#39;loess&#39;, se = FALSE, size = 1.5)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="/rcode/model-intro_files/figure-html/smoother-1.png" width="672" /></p>
<p>It may also be useful to calculate a correlation coefficient between these two variables.</p>
<pre class="r"><code>with(fandango, cor(rottentomatoes, metacritic))</code></pre>
<pre><code>## [1] 0.9573596</code></pre>
<div id="fit-linear-regression" class="section level3">
<h3>Fit Linear Regression</h3>
<p>Now we will attempt to fit a model to these data. Namely, the relationship appears to be mostly linear and suppose we wished to predict the metacritic review score with the rotten tomatoes score. To do this, we will use the <code>lm</code> function and the <code>~</code> that we used with <code>facet_wrap</code> and <code>facet_grid</code>.</p>
<p>More concretely, suppose we wished to fit the model:
<span class="math display">\[ metacritic_{i} = b_{0} + b_{1} rottentomatoes_{i} + \epsilon_{i} \]</span></p>
<p>In this model, <span class="math inline">\(metacritic_{i}\)</span> is the dependent or response variable and <span class="math inline">\(rottentomatoes_{i}\)</span> is the independent, predictor, or covariate. In many traditional statistics courses, <span class="math inline">\(metacritic_{i}\)</span> would be represented with <span class="math inline">\(Y\)</span> and <span class="math inline">\(rottentomatoes_{i}\)</span> would be represented with <span class="math inline">\(X\)</span>. It is often more descriptive to represent these with their variable names instead of <span class="math inline">\(Y\)</span> or <span class="math inline">\(X\)</span>.</p>
<p>To fit this model, we simply need to replace the <span class="math inline">\(=\)</span> sign found in the equation above with the <code>~</code>. For example, the equation above would turn into:</p>
<pre class="r"><code>meta_mod &lt;- lm(metacritic ~ rottentomatoes, data = fandango)</code></pre>
<p>To see output from the model, we can take two approaches. One is to use <code>summary</code> and another is to use the <code>tidy</code> function from the broom package. I show each below in turn.</p>
<pre class="r"><code>summary(meta_mod)</code></pre>
<pre><code>## 
## Call:
## lm(formula = metacritic ~ rottentomatoes, data = fandango)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -11.7209  -4.1999   0.3855   3.7952  14.6662 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    21.12097    1.05710   19.98   &lt;2e-16 ***
## rottentomatoes  0.61935    0.01558   39.77   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.658 on 144 degrees of freedom
## Multiple R-squared:  0.9165, Adjusted R-squared:  0.916 
## F-statistic:  1581 on 1 and 144 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>tidy(meta_mod)</code></pre>
<pre><code>## # A tibble: 2 x 5
##   term           estimate std.error statistic  p.value
##   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)      21.1      1.06        20.0 2.36e-43
## 2 rottentomatoes    0.619    0.0156      39.8 1.54e-79</code></pre>
<p>With the broom package, the results are reported in a tidier framework. We will see additional useful functions using the broom package later on.</p>
<p>You can also directly request confidence intervals with the <code>tidy</code> function:</p>
<pre class="r"><code>tidy(meta_mod, conf.int = TRUE)</code></pre>
<pre><code>## # A tibble: 2 x 7
##   term           estimate std.error statistic  p.value conf.low conf.high
##   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)      21.1      1.06        20.0 2.36e-43   19.0      23.2  
## 2 rottentomatoes    0.619    0.0156      39.8 1.54e-79    0.589     0.650</code></pre>
<div id="exercises" class="section level4">
<h4>Exercises</h4>
<ol style="list-style-type: decimal">
<li>Fit a new model using the <code>fandango</code> data that attempts to explain the metacritic ratings with the imdb rating.</li>
<li>Fit another model using the <code>fandango</code> data that attempts to explain the metacritic ratings with the fandango_ratingvalue scores.</li>
<li>Exploring the predictors of these two new models with the one fitted above with the rottentomatoes scores, which rating score best helps us predict the metacritic scores?</li>
</ol>
</div>
</div>
<div id="workings-behind-lm-function" class="section level3">
<h3>Workings Behind <code>lm</code> function</h3>
<p>To see what the <code>lm</code> function is doing behind the scenes, we will use the <code>model_matrix</code> function from the modelr package. For example, from the model above:</p>
<pre class="r"><code>model_matrix(fandango, metacritic ~ rottentomatoes)</code></pre>
<pre><code>## # A tibble: 146 x 2
##    `(Intercept)` rottentomatoes
##            &lt;dbl&gt;          &lt;dbl&gt;
##  1             1             74
##  2             1             85
##  3             1             80
##  4             1             18
##  5             1             14
##  6             1             63
##  7             1             42
##  8             1             86
##  9             1             99
## 10             1             89
## # … with 136 more rows</code></pre>
<p>This is often referred to as the design matrix in statistics text books and is one of the matrices that are used by <code>lm</code> to calculate the estimated parameters from above. Notice that is automatically included the intercept, normally this is of interest, if it is not, we can omit it directly by including a <code>-1</code> in the formula. For example:</p>
<pre class="r"><code>model_matrix(fandango, metacritic ~ rottentomatoes - 1)</code></pre>
<pre><code>## # A tibble: 146 x 1
##    rottentomatoes
##             &lt;dbl&gt;
##  1             74
##  2             85
##  3             80
##  4             18
##  5             14
##  6             63
##  7             42
##  8             86
##  9             99
## 10             89
## # … with 136 more rows</code></pre>
<pre class="r"><code>tidy(lm(metacritic ~ rottentomatoes - 1, data = fandango))</code></pre>
<pre><code>## # A tibble: 1 x 5
##   term           estimate std.error statistic   p.value
##   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 rottentomatoes    0.898    0.0134      67.3 3.14e-111</code></pre>
<p>You need to be careful with this syntax as this is commonly not is what is desired when fitting a linear model.</p>
</div>
<div id="categorical-predictors" class="section level3">
<h3>Categorical Predictors</h3>
<p>Suppose we were interested in the following research question:</p>
<ul>
<li>To what extent are there average differences in movie ratings between rottentomatoes and metacritic?</li>
</ul>
<p>To answer this research question, we would need to transform our data to great a group variable and a rating variable.</p>
<pre class="r"><code>meta_rotten &lt;- fandango %&gt;%
  select(film, year, rottentomatoes, metacritic) %&gt;%
  gather(group, rating, rottentomatoes, metacritic)
meta_rotten</code></pre>
<pre><code>## # A tibble: 292 x 4
##    film                     year group          rating
##    &lt;chr&gt;                   &lt;dbl&gt; &lt;chr&gt;           &lt;int&gt;
##  1 Avengers: Age of Ultron  2015 rottentomatoes     74
##  2 Cinderella               2015 rottentomatoes     85
##  3 Ant-Man                  2015 rottentomatoes     80
##  4 Do You Believe?          2015 rottentomatoes     18
##  5 Hot Tub Time Machine 2   2015 rottentomatoes     14
##  6 The Water Diviner        2015 rottentomatoes     63
##  7 Irrational Man           2015 rottentomatoes     42
##  8 Top Five                 2014 rottentomatoes     86
##  9 Shaun the Sheep Movie    2015 rottentomatoes     99
## 10 Love &amp; Mercy             2015 rottentomatoes     89
## # … with 282 more rows</code></pre>
<p>Now we can work with this data to answer the question from above. More specifically, our dependent variable will be the rating variable and the independent variable will be the group (categorical) variable. This can be fitted within a linear model as follows:</p>
<pre class="r"><code>tidy(lm(rating ~ factor(group), data = meta_rotten))</code></pre>
<pre><code>## # A tibble: 2 x 5
##   term                        estimate std.error statistic  p.value
##   &lt;chr&gt;                          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)                    58.8       2.10    28.0   2.50e-84
## 2 factor(group)rottentomatoes     2.04      2.97     0.686 4.93e- 1</code></pre>
<p>To see exactly what is happening, <code>model_matrix</code> may be useful. First I am going to arrange the data by the films in alphabetical order.</p>
<pre class="r"><code>meta_rotten %&gt;%
  arrange(film)</code></pre>
<pre><code>## # A tibble: 292 x 4
##    film                 year group          rating
##    &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;           &lt;int&gt;
##  1 &#39;71                  2015 rottentomatoes     97
##  2 &#39;71                  2015 metacritic         83
##  3 5 Flights Up         2015 rottentomatoes     52
##  4 5 Flights Up         2015 metacritic         55
##  5 A Little Chaos       2015 rottentomatoes     40
##  6 A Little Chaos       2015 metacritic         51
##  7 A Most Violent Year  2014 rottentomatoes     90
##  8 A Most Violent Year  2014 metacritic         79
##  9 About Elly           2015 rottentomatoes     97
## 10 About Elly           2015 metacritic         87
## # … with 282 more rows</code></pre>
<pre class="r"><code>meta_rotten %&gt;%
  arrange(film) %&gt;%
  model_matrix(rating ~ factor(group))</code></pre>
<pre><code>## # A tibble: 292 x 2
##    `(Intercept)` `factor(group)rottentomatoes`
##            &lt;dbl&gt;                         &lt;dbl&gt;
##  1             1                             1
##  2             1                             0
##  3             1                             1
##  4             1                             0
##  5             1                             1
##  6             1                             0
##  7             1                             1
##  8             1                             0
##  9             1                             1
## 10             1                             0
## # … with 282 more rows</code></pre>
<p>You may be more familiar with using a t-test for this type of design. We can replicate the results above with a t-test using the <code>t.test</code> function.</p>
<pre class="r"><code>t.test(rating ~ factor(group), data = meta_rotten, 
       var.equal = TRUE)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  rating by factor(group)
## t = -0.68638, df = 290, p-value = 0.493
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -7.893918  3.811726
## sample estimates:
##     mean in group metacritic mean in group rottentomatoes 
##                     58.80822                     60.84932</code></pre>
<div id="exercises-1" class="section level4">
<h4>Exercises</h4>
<ol style="list-style-type: decimal">
<li>Compute descriptive means using the <code>meta_rotten</code> transformed data from above by the group variable. Do these means appear to be descriptively different?</li>
<li>How do these means relate to the parameters estimated from the model above?</li>
</ol>
</div>
</div>
<div id="evaulating-model-fit" class="section level3">
<h3>Evaulating Model fit</h3>
<p>There are many ways to evaluate model fit. Many of these are available using the <code>summary</code> function.</p>
<pre class="r"><code>summary(lm(rating ~ factor(group), data = meta_rotten))</code></pre>
<pre><code>## 
## Call:
## lm(formula = rating ~ factor(group), data = meta_rotten)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -55.849 -19.089   0.671  22.161  39.151 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   58.808      2.103  27.967   &lt;2e-16 ***
## factor(group)rottentomatoes    2.041      2.974   0.686    0.493    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 25.41 on 290 degrees of freedom
## Multiple R-squared:  0.001622,   Adjusted R-squared:  -0.001821 
## F-statistic: 0.4711 on 1 and 290 DF,  p-value: 0.493</code></pre>
<p>The unfortunate part of this is the fact that these are more difficult to pull out of the table programmatically (i.e. in a reproducible workflow). This is where the broom package helps with the use of the <code>glance</code> function.</p>
<pre class="r"><code>glance(lm(rating ~ factor(group), data = meta_rotten))</code></pre>
<pre><code>## # A tibble: 1 x 12
##   r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1   0.00162      -0.00182  25.4     0.471   0.493     1 -1358. 2722. 2733.
## # … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<p>These are now in a more tidy data frame and if you have multiple models in an exploratory analysis, these could then be much easier compared and combined programmatically to come to a final model.</p>
<p>Another useful function from the broom package is <code>augment</code>. This function will add additional information to the original data such as residuals, fitted (predicted) values, and other diagnostic statistics.</p>
<pre class="r"><code>diagnostic &lt;- augment(lm(rating ~ factor(group), data = meta_rotten))
diagnostic</code></pre>
<pre><code>## # A tibble: 292 x 7
##    rating `factor(group)` .fitted    .hat .sigma   .cooksd .std.resid
##     &lt;int&gt; &lt;fct&gt;             &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
##  1     74 rottentomatoes     60.8 0.00685   25.4 0.000930      0.519 
##  2     85 rottentomatoes     60.8 0.00685   25.4 0.00314       0.954 
##  3     80 rottentomatoes     60.8 0.00685   25.4 0.00197       0.756 
##  4     18 rottentomatoes     60.8 0.00685   25.3 0.00988      -1.69  
##  5     14 rottentomatoes     60.8 0.00685   25.3 0.0118       -1.85  
##  6     63 rottentomatoes     60.8 0.00685   25.5 0.0000249     0.0849
##  7     42 rottentomatoes     60.8 0.00685   25.4 0.00191      -0.744 
##  8     86 rottentomatoes     60.8 0.00685   25.4 0.00340       0.993 
##  9     99 rottentomatoes     60.8 0.00685   25.4 0.00783       1.51  
## 10     89 rottentomatoes     60.8 0.00685   25.4 0.00426       1.11  
## # … with 282 more rows</code></pre>
<p>These could then be plotted to explore more information about model fit. For example a histogram of the standardized residuals are often useful.</p>
<pre class="r"><code>ggplot(diagnostic, aes(.std.resid)) + 
  geom_histogram(bins = 30, color = &#39;white&#39;) + 
  theme_bw()</code></pre>
<p><img src="/rcode/model-intro_files/figure-html/hist_resid-1.png" width="672" /></p>
<p>For this model, boxplots of the standardized residuals by the two groups can also be informative:</p>
<pre class="r"><code>ggplot(diagnostic, aes(`factor(group)`, .std.resid)) + 
  geom_boxplot() + 
  geom_jitter() + 
  coord_flip() +
  theme_bw()</code></pre>
<p><img src="/rcode/model-intro_files/figure-html/boxplot_resid-1.png" width="672" /></p>
<p>We will explore more details on predicted or fitted values later.</p>
<p>Lastly, the <code>augment</code> function can be useful, however I personally do not like the naming convention used by the function. I want to point you to two additional functions from the modelr package that can be useful for predicted (<code>add_predictions</code>) and residual values (<code>add_residuals</code>).</p>
<p>For example, to add the residuals to the original data:</p>
<pre class="r"><code>meta_rotten %&gt;%
  add_residuals(lm(rating ~ factor(group), data = meta_rotten))</code></pre>
<pre><code>## # A tibble: 292 x 5
##    film                     year group          rating  resid
##    &lt;chr&gt;                   &lt;dbl&gt; &lt;chr&gt;           &lt;int&gt;  &lt;dbl&gt;
##  1 Avengers: Age of Ultron  2015 rottentomatoes     74  13.2 
##  2 Cinderella               2015 rottentomatoes     85  24.2 
##  3 Ant-Man                  2015 rottentomatoes     80  19.2 
##  4 Do You Believe?          2015 rottentomatoes     18 -42.8 
##  5 Hot Tub Time Machine 2   2015 rottentomatoes     14 -46.8 
##  6 The Water Diviner        2015 rottentomatoes     63   2.15
##  7 Irrational Man           2015 rottentomatoes     42 -18.8 
##  8 Top Five                 2014 rottentomatoes     86  25.2 
##  9 Shaun the Sheep Movie    2015 rottentomatoes     99  38.2 
## 10 Love &amp; Mercy             2015 rottentomatoes     89  28.2 
## # … with 282 more rows</code></pre>
<div id="exercises-2" class="section level4">
<h4>Exercises</h4>
<ol style="list-style-type: decimal">
<li>Fit a new model using the <code>fandango</code> data that attempts to explain the metacritic ratings with the imdb rating. Explore the distribution of residuals. Does there appear to be problems with these residuals?</li>
<li>Using the model from #1, create a scatterplot that displays the residuals by the predictor variable. Are there problems with this plot that we should be concerned with?</li>
</ol>
</div>
</div>
</div>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/rcode/strings/" rel="next">Working with Character Strings</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/rcode/model-part2/" rel="prev">Building Upon Linear Models</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on Mar 16, 2021</p>

          



          




          


        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'event' : "Events",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/js/wowchemy.min.d4185df71ecf716f1c4e7ef5f3d4e2b8.js"></script>

    






</body>
</html>
